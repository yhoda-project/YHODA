# Prefect v3 deployment manifest — Yorkshire Vitality Observatory pipeline
# Apply with: prefect deploy --all --no-prompt
# Note: schedule values are plain dicts (YAML keys), NOT Python class names.

name: yhovi-pipeline
prefect-version: "3.*"

# ---------------------------------------------------------------------------
# Shared definitions (referenced via YAML anchors)
# ---------------------------------------------------------------------------
definitions:
  schedules:
    monthly_0600: &monthly_0600
      cron: "0 6 1 * *"
      timezone: "Europe/London"

  work_pool: &default_work_pool
    name: yhovi-default

  common: &common
    work_pool: *default_work_pool
    schedule: *monthly_0600

# ---------------------------------------------------------------------------
# Deployments — 13 total
# ---------------------------------------------------------------------------
deployments:

  # ── Economy flows ──────────────────────────────────────────────────────────
  - name: economy/employment-jobs
    entrypoint: src/yhovi_pipeline/flows/economy/employment_jobs.py:employment_jobs_flow
    <<: *common

  - name: economy/claimant-count
    entrypoint: src/yhovi_pipeline/flows/economy/claimant_count.py:claimant_count_flow
    <<: *common

  - name: economy/business-demography
    entrypoint: src/yhovi_pipeline/flows/economy/business_demography.py:business_demography_flow
    <<: *common

  - name: economy/gdp-gva
    entrypoint: src/yhovi_pipeline/flows/economy/gdp_gva.py:gdp_gva_flow
    <<: *common

  # ── Society flows ──────────────────────────────────────────────────────────
  - name: society/health-outcomes
    entrypoint: src/yhovi_pipeline/flows/society/health_outcomes.py:health_outcomes_flow
    <<: *common

  - name: society/education-attainment
    entrypoint: src/yhovi_pipeline/flows/society/education_attainment.py:education_attainment_flow
    <<: *common

  - name: society/housing-tenure
    entrypoint: src/yhovi_pipeline/flows/society/housing_tenure.py:housing_tenure_flow
    <<: *common

  - name: society/deprivation-imd
    entrypoint: src/yhovi_pipeline/flows/society/deprivation_imd.py:deprivation_imd_flow
    <<: *common

  - name: society/crime-statistics
    entrypoint: src/yhovi_pipeline/flows/society/crime_statistics.py:crime_statistics_flow
    <<: *common

  - name: society/physical-activity
    entrypoint: src/yhovi_pipeline/flows/society/physical_activity.py:physical_activity_flow
    <<: *common

  - name: society/digital-inclusion
    entrypoint: src/yhovi_pipeline/flows/society/digital_inclusion.py:digital_inclusion_flow
    <<: *common

  # ── Environment flows ──────────────────────────────────────────────────────
  - name: environment/air-quality
    entrypoint: src/yhovi_pipeline/flows/environment/air_quality.py:air_quality_flow
    <<: *common

  - name: environment/energy-consumption
    entrypoint: src/yhovi_pipeline/flows/environment/energy_consumption.py:energy_consumption_flow
    <<: *common
